<% layout('layouts/boilerplate')%>

    <div class="d-flex justify-content-between mt-5 mb-2">
        <label for="projectTable" class="h2">Dự án của bạn</label>

    </div>

    <!-- end modal form -->
    <div class="manageTable" id="projectTable">
        <div class="row g-2 g-xxl-1">
            <% for(let project of ownProjects) { %>
                <div class="col-md-6 col-xxl-3">
                    <div class="card d-block">
                        <div class="card-body overflow-hidden" style="height: 200px">
                            <!-- project title-->
                            <h4 class="mt-0 manage-page-project-header ">
                                <a href="/projects/<%= project.id %>" class="card-title tree-menu-link">
                                    <%= project.title.length> 70?
                                        `${project.title.substring(0,70)}...`:project.title %>
                                </a>
                            </h4>
                            <% const completed=project.progress==100? true:false %>
                                <div class="badge bg-<%= completed? 'success':'warning' %>">
                                    <%= completed? 'Đã hoàn thành' :'Đang thực hiện' %>
                                </div>



                                <p class="text-muted font-13 my-3 ">
                                    <%= project.description.length> 170?
                                        `${project.description.substring(0,
                                        170)}...`:project.description %>
                                        <% if(project.description.length> 170) {%>
                                            <sub><a href="/projects/<%= project.id %>" class="sub-link">Chi
                                                    tiết</a></sub>
                                            <%}%>
                                </p>
                        </div>
                        <!-- end card-body-->
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item p-3">
                                <!-- project progress-->
                                <p class="mb-2 fw-bold">
                                    Tiến độ <span class="float-end">
                                        <%= project.progress %>%
                                    </span>
                                </p>
                                <div class="progress progress-sm">
                                    <div class="progress-bar" role="progressbar" aria-valuenow="100" aria-valuemin="0"
                                        aria-valuemax="100" style="width: <%= project.progress%>%"></div>
                                    <!-- /.progress-bar -->
                                </div>
                                <!-- /.progress -->
                            </li>
                        </ul>
                    </div>
                </div>
                <% } %>
        </div>
    </div>





    <% if(isAdmin) { %>

        <div class="d-flex justify-content-between mt-5 mb-2">
            <label for="projectTable" class="h2">Tất cả dự án</label>
            <div>
                <a href="/projects/new" class="btn btn-primary"><svg xmlns="http://www.w3.org/2000/svg" width="16"
                        height="16" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">
                        <path fill-rule="evenodd"
                            d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2Z" />
                    </svg></a>
            </div>
        </div>

        <!-- end modal form -->
        <div class="manageTable" id="projectTable">
            <div class="row g-2 g-xxl-1">
                <% for(let project of projects) { %>
                    <div class="col-md-6 col-xxl-3">
                        <div class="card d-block">
                            <div class="card-body manage-page-project-body">
                                <!-- project title-->
                                <h4 class="mt-0 manage-page-project-header ">
                                    <a href="/projects/<%= project.id %>" class="card-title tree-menu-link">
                                        <%= project.title.length> 70?
                                            `${project.title.substring(0,70)}...`:project.title %>
                                    </a>
                                </h4>
                                <% const completed=project.progress==100? true:false %>
                                    <div class="badge bg-<%= completed? 'success':'warning' %>">
                                        <%= completed? 'Đã hoàn thành' :'Đang thực hiện' %>
                                    </div>

                                    <p class="text-muted font-13 my-3 ">
                                        <%= project.description.length> 170?
                                            `${project.description.substring(0,
                                            170)}...`:project.description %>
                                            <% if(project.description.length> 170) {%>
                                                <sub><a href="/projects/<%= project.id %>" class="sub-link">Chi
                                                        tiết</a></sub>
                                                <% } %>
                                    </p>

                                    <!-- project detail-->
                            </div>
                            <!-- end card-body-->
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item p-3">
                                    <!-- project progress-->
                                    <p class="mb-2 fw-bold">
                                        Tiến độ <span class="float-end">
                                            <%= project.progress %>%
                                        </span>
                                    </p>
                                    <div class="progress progress-sm">
                                        <div class="progress-bar" role="progressbar" aria-valuenow="100"
                                            aria-valuemin="0" aria-valuemax="100"
                                            style="width: <%= project.progress%>%"></div>
                                        <!-- /.progress-bar -->
                                    </div>
                                    <!-- /.progress -->
                                </li>
                            </ul>
                        </div>
                    </div>
                    <% } %>
            </div>
        </div>
        <% } %>